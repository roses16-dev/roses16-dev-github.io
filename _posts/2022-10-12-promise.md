---
layout: single
title: "[javascript] Promise"
categories: javascript
tags: javascript
toc: true
sidebar:
  nav: "docs"
---

Promiseì— ëŒ€í•œ ì •ë¦¬ ðŸ“•



#### Promise ê°ì²´

---

promiseëŠ” { state, result } í˜•íƒœì˜ ê°ì²´ì´ë‹¤.

stateëŠ” Promiseì˜ ìƒíƒœë¥¼ í‘œì‹œí•œë‹¤. ì´ˆê¸°ê°’ì€ pending(ëŒ€ê¸°), resolveê°€ í˜¸ì¶œë˜ë©´ fulfilled(ì´í–‰), rejectê°€ í˜¸ì¶œë˜ë©´ rejected(ê±°ë¶€) ê°’ì„ ê°–ê³ , ë‘˜ ì¤‘ í•œê°€ì§€ë¡œ ì™„ë£Œëœ ì´í›„ì—ëŠ” setteled ìƒíƒœë¥¼ ê°–ëŠ”ë‹¤.

resultëŠ” resolveê°€ í˜¸ì¶œë˜ì—ˆì„ ë•Œì—ëŠ” í•¨ìˆ˜ì— ì „ë‹¬ëœ ê°’. ì•„ëž˜ ì˜ˆì‹œ `resolve('OK')`ì—ì„œ 'OK'ë¥¼ ê°’ìœ¼ë¡œ ê°–ê³ , rejectê°€ í˜¸ì¶œë˜ì—ˆì„ ë•Œì—ëŠ” í•´ë‹¹ í•¨ìˆ˜ì— ì „ë‹¬ëœ Errorë¥¼ ê°’ìœ¼ë¡œ ê°–ëŠ”ë‹¤.

Promiseë¥¼ ì‚¬ìš©í•˜ë©´ ë¹„ë™ê¸°ì  í•¨ìˆ˜ë¥¼ ë™ê¸°ì ì¸ ê²ƒì²˜ëŸ¼ ë³´ì´ê²Œ í•  ìˆ˜ ìžˆë‹¤.



#### ì‚¬ìš©í•˜ê¸°

---

- Promise ìƒì„±

  `new Promise( (F_RESOLVE, F_REJECT) => { FUNCTION } )`

  Promise ê°ì²´ë¥¼ ìƒì„±í•œë‹¤. `F_RESOLVE`ì™€ `F_REJECT`ëŠ” ê°ê° ì„±ê³µ, ì‹¤íŒ¨ë¥¼ ì˜ë¯¸í•˜ëŠ” í•¨ìˆ˜ì´ë‹¤.

  ```javascript
  const pr = new Promise((resolve, reject) => {
      setTimeout(() => {
          resolve('OK')
      }, 3000)
  })
  ```

  

- `then(F_SUCCESS, F_FAILED)`

  í”„ë¡œë¯¸ìŠ¤ê°€ reselveë¥¼ ì‹¤í–‰ì‹œì¼°ì„ ë•Œì™€ rejectë¥¼ ì‹¤í–‰ì‹œì¼°ì„ë•Œì˜ í•¨ìˆ˜ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ì•„, í”„ë¡œë¯¸ìŠ¤ì˜ stateì— ë”°ë¼ í•´ë‹¹í•˜ëŠ” í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.

  ```javascript
  pr.then(
      function(result) {
          console.log('ì„±ê³µ')
      },
      function(err){
          console.log('ì‹¤íŒ¨')
      }
  )
  ```



- `catch`

  í”„ë¡œë¯¸ìŠ¤ê°€ rejectë¥¼ ì‹¤í–‰ì‹œì¼°ì„ ë•Œ ë§¤ê°œë³€ìˆ˜ì˜ í•¨ìˆ˜ë¥¼ ì‹¤í–‰í•œë‹¤.

  ```javascript
  pr.catch(function(err){
      console.log('ì‹¤íŒ¨')
  })
  ```

  

- `then`ê³¼ `catch`ë¬¸ì„ í•¨ê»˜ ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ê°€ë…ì„±ì— ì¢‹ë‹¤.

  ```javascript
  pr.then(
      function(result) { console.log('ì„±ê³µ') }
  ).catch(
      function(err){ console.log('ì‹¤íŒ¨')}
  )
  ```

  

- `finally` 

  ì„±ê³µ, ì‹¤íŒ¨ì™€ ê´€ê³„ì—†ì´ ê°€ìž¥ ë§ˆì§€ë§‰ì— ì‹¤í–‰ëœë‹¤.

  ```javascript
  pr.then(
      function(result) { console.log('ì„±ê³µ') }
  ).catch(
      function(err){ console.log('ì‹¤íŒ¨')}
  ).finally(
      function(){ console.log('ì¢…ë£Œ')}
  )
  ```

  

- ì½œë°±ì§€ì˜¥

  depsê°€ ê¹Šì–´ì§€ë©° ì—¬ëŸ¬ê°œì˜ ì½œë°±í•¨ìˆ˜ê°€ ì‹¤í–‰ë˜ëŠ” ê²ƒ

  ```javascript
  const f1 = (callback) => { setTimeout(function() { console.log('1ë²ˆ'); callback(); }, 1000)} )
  const f2 = (callback) => { setTimeout(function() { console.log('2ë²ˆ'); callback(); }, 2000)} )
  const f3 = (callback) => { setTimeout(function() { console.log('3ë²ˆ'); callback(); }, 3000)} )
  
  f1(function(){
      f2(function(){
          f3(function(){
              console.log('ë')
          })
      })
  }
  ```



- í”„ë¡œë¯¸ìŠ¤ ì²´ì´ë‹

  í”„ë¡œë¯¸ìŠ¤ë¡œ ì—¬ëŸ¬ê°œì˜ í•¨ìˆ˜ë¥¼ ì—°ê²°í•˜ëŠ” ê²ƒ.

  ```javascript
  const f1 = (msg) => { console.log(msg);
                       return new Promise((res, rej) => { setTimeout(function() { res('1ë²ˆ');}, 1000)} );
  const f2 = (msg) => { console.log(msg);
                       return new Promise((res, rej) => { setTimeout(function() { res('2ë²ˆ');}, 2000)} );
  const f3 = (msg) => { console.log(msg);
                       return new Promise((res, rej) => { setTimeout(function() { res('3ë²ˆ');}, 3000)} );
  
  f1
  .then( res => f2(res))
  .then( res => f3(res))
  .then( res => console.log(res))                  
  ```

  

- Promise.all

  ë‹¤ìˆ˜ì˜ í•¨ìˆ˜ë¥¼ ë°°ì—´ë¡œ ë°›ì•„ ëª¨ë‘ ì´í–‰ë˜ì—ˆì„ ë•Œ thenì„ ì‹¤í–‰ì‹œí‚¨ë‹¤.

  ```java
  Promise.all([FUNTION1, FUNCTION2, FUNCTION3, ...]).then() 
  ```



- Promise.race

  ë‹¤ìˆ˜ì˜ í•¨ìˆ˜ë¥¼ ë°°ì—´ë¡œ ë°›ì•„ ê°€ìž¥ ë¹ ë¥¸ 1ê°œê°€ ì´í–‰ë˜ì—ˆì„ ë•Œ thenì„ ì‹¤í–‰ì‹œí‚¨ë‹¤.

  ```java
  Promise.race([FUNTION1, FUNCTION2, FUNCTION3, ...]).then() 
  ```



#### ì¶œì²˜

> - https://youtu.be/3Ao3OroqQLQ