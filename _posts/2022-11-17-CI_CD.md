---
layout: single
title: "[Github] Github action, AWS S3, Gabia domainì„ ì´ìš©í•œ ìë™ë°°í¬"
categories: Github
tags: Github, ìë™ë°°í¬, AWS
sidebar:
  nav: "docs"
---



11ì›” 17ì¼. ì˜¤ëŠ˜ì˜ ë°°ì›€~~(ì‚½ì§ˆ)~~ 

ì˜¤ëŠ˜ì˜ í¬ìŠ¤íŒ…ì€ ì œê°€ ì„±ê³µí•œ ë°©ë²•ì— ëŒ€í•œ ë©”ëª¨ì…ë‹ˆë‹¤. ë¹„êµì  ìì„¸í•œ ì„¤ëª…ì´ ë¶€ì¡±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ğŸ˜¥

Gabia domainì´ ìˆê³ , AWS ê³„ì •ì´ ìˆê³ , Github repoê°€ ë§Œë“¤ì–´ì ¸ ìˆë‹¤ëŠ” ê±¸ ì „ì œë¡œ ì‹œì‘í•©ë‹ˆë‹¤. 

ì´ ë°©ì‹ì€ AWS S3 ì •ì  í˜¸ìŠ¤íŒ…ì„ ì´ìš©í•œ ë°©ì‹ì´ë©° httpë¥¼ ì§€ì›í•©ë‹ˆë‹¤. https ë°°í¬ê°€ í•„ìš”í•˜ë‹¤ë©´ "AWS EC2 + ACM" ë˜ëŠ” "AWS Amplify"ë¥¼ ì´ìš©í•´ì•¼í•©ë‹ˆë‹¤.



### ëª©ì°¨

1. AWS 'Route 53' í˜¸ìŠ¤íŒ… ì˜ì—­ ìƒì„±  & Gabia DNS ë³€ê²½
2. AWS S3 ë²„í‚· ìƒì„± ë° ê¶Œí•œ/ì†ì„± ë³€ê²½
3. AWS 'IAM' ì‚¬ìš©ì ì¶”ê°€
4. Git Action 



### 1. AWS 'Route 53' í˜¸ìŠ¤íŒ… ì˜ì—­ ìƒì„±  & Gabia DNS ë³€ê²½

â€‹	AWSì—ì„œ ì™¸ë¶€ Domainì„ ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” AWSì˜ DNS ì„œë¹„ìŠ¤ì¸ 'Route 53'ì— ë“±ë¡ì´ í•„ìš”í•˜ë©°, Route 53ì˜ DNSì„œë²„ë¥¼ Gabia DNS ì„œë²„ë¥¼ ëŒ€ì²´í•˜ì—¬ ì‚¬ìš©í•©ë‹ˆë‹¤.

- AWS 'Route 53' > 'í˜¸ìŠ¤íŒ… ì˜ì—­' > 'í˜¸ìŠ¤íŒ… ì˜ì—­ ìƒì„±'

  ![image-20221118055301132](\images\2022-11-17-CI_CD\image-20221118055301132.png)

â€‹	`domain_name.dev`ëŠ” ì‚¬ìš©í•  Domainìœ¼ë¡œ ë³€ê²½



 - ìƒì„±ëœ í˜¸ìŠ¤íŒ… click > 'ë ˆì½”ë“œ ìƒì„±'

   ![image-20221118062727227](\images\2022-11-17-CI_CD\image-20221118062727227.png)

   

 - í˜¸ìŠ¤íŒ… ì˜ì—­ ì„¸ë¶€ ì •ë³´ ë‚´ 'NS' ìœ í˜•ì˜ ê°’/íŠ¸ë˜í”½ ë¼ìš°íŒ… ëŒ€ìƒ ì»¬ëŸ¼ì˜ ê°’ì„ Gabia DNS ì„œë²„ë¡œ ì„¤ì •

![image-20221118062922524](\images\2022-11-17-CI_CD\image-20221118062922524.png)



### 2. AWS S3 ë²„í‚· ìƒì„± ë° ê¶Œí•œ/ì†ì„± ë³€ê²½

- AWS 'S3' > 'ë²„í‚· ë§Œë“¤ê¸°' > ì•„ë˜ì™€ ê°™ì´ ì„¤ì • í›„ 'ë²„í‚· ë§Œë“¤ê¸°'

  ![image-20221118062009601](\images\2022-11-17-CI_CD\image-20221118062009601.png)



- AWS 'S3' > ìƒì„±í•œ ë²„í‚· click > 'ê¶Œí•œ' > ë²„í‚· ì •ì±… > í¸ì§‘

  ```
  {
      "Version": "2012-10-17",
      "Id": "Policy1668671586744",
      "Statement": [
          {
              "Sid": "AddPerm",
              "Effect": "Allow",
              "Principal": "*",
              "Action": "s3:GetObject",
              "Resource": "arn:aws:s3:::domain_name.dev/*"
          }
      ]
  }
  ```

  

- AWS 'S3' > ìƒì„±í•œ ë²„í‚· click > 'ì†ì„±' > 'ì •ì  ì›¹ ì‚¬ì´íŠ¸ í˜¸ìŠ¤íŒ… í¸ì§‘' > í™œì„±í™”



### 3. IAM ì‚¬ìš©ì ì¶”ê°€

ì´ë¯¸ ê°™ì€ ì„¤ì •ìœ¼ë¡œ ìƒì„±ëœ ì‚¬ìš©ìê°€ ìˆë‹¤ë©´ ìƒëµí•´ë„ ë©ë‹ˆë‹¤.

- AWS 'IAM' > 'ì‚¬ìš©ì' > 'ì‚¬ìš©ì ì¶”ê°€'
  - AWS ìê²© ì¦ëª… ìœ í˜• : 'ì•¡ì„¸ìŠ¤ í‚¤ - í”„ë¡œê·¸ë˜ë° ë°©ì‹ ì•¡ì„¸ìŠ¤' ì²´í¬
  - Permissions : 'AmazonS3FullAccess'

- ì¶”ê°€ ì‹œ ë°›ì„ ìˆ˜ ìˆëŠ” 'ì•¡ì„¸ìŠ¤ í‚¤', 'ë¹„ë°€ ì•¡ì„¸ìŠ¤ í‚¤' ë©”ëª¨ 



### 4. ë“œë””ì–´ Git Action 

- ì›ê²© repo > Actions > 'set up a workflow yourself'

  ```yaml
  name: Node.js Package
  
  on:
    push:
      branches: [main]
    pull_request:
      branches: [main]
  
  jobs:
    deploy:
      runs-on: ubuntu-latest
      env: 
        CI: false
      steps:
        - uses: actions/checkout@v3
  
        - name: Install dependencies
          run: yarn
  
        - name: Build
          run: yarn build
        
        - name: Configure AWS Credentials
          uses: aws-actions/configure-aws-credentials@v1
          with:
            aws-access-key-id: ${{ secrets.AWS_ACCESS_KEY_ID }}			# AWS ì‚¬ìš©ì ACCESS KEY
            aws-secret-access-key: ${{ secrets.AWS_SECRET_ACCESS_KEY }}	# AWS ì‚¬ìš©ì SECRET ACCESS KEY
            aws-region: ap-southeast-2
  
        - name: Deploy static site to S3 bucket
          run: aws s3 sync ./build s3://${{ secrets.S3_BUCKET }} --delete	# AWS BUCKET NAME
  ```

  .yml íŒŒì¼ì˜ ì‘ì„± ë°©ì‹ ì„¤ëª…ì€ ìƒëµí•˜ê² ìŠµë‹ˆë‹¤.

- ìœ„ ì˜ˆì œì—ì„œ ì‚¬ìš©ëœ action secret key ëŠ” Git repo > Settings > Secrets ì—ì„œ ë“±ë¡í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤!

  



#### ğŸ“Œ ì¶œì²˜

- https://eundol1113.tistory.com/210
- https://medium.com/marlinelee2/react-amazon-s3%EB%A1%9C-%ED%98%B8%EC%8A%A4%ED%8C%85-417aa93cf469
- https://hannut91.github.io/blogs/route53/gabia
- https://grasinnong-developer.tistory.com/88
- https://velog.io/@cptkuk91/AWS-S3Route53-%ED%98%B8%EC%8A%A4%ED%8C%85-%EB%8F%84%EB%A9%94%EC%9D%B8-%EC%97%B0%EA%B2%B0
- https://react-etc.vlpt.us/08.deploy-s3.html
- https://blog.naver.com/ipzzinn/222925361366
- https://satisfactoryplace.tistory.com/361
- https://doqtqu.tistory.com/331

